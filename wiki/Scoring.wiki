#summary How scoring will work.

= Introduction =

This is pretty tricky because it isn't clear what should depend on what, e.g. you could give tracks a higher score based on the top artists but you could also give artists a score based on the score of their tracks.


= Details =

Each track has:
  * A track name
  * An artist name
  * A list of the tracks that are related to it, with scores (inverse of the results from track.getSimilar)

Each artist has:
  * An artist name
  * A list of the artists that are similar to it, with scores (inverse of artist.getSimilar)
  * A list of tracks (with play count if available)

= Similar Track Scoring =
{{{
  Find max similarity score (or keep this as a member and update when new scores are found)
  Set all scores to -1
  For all tracks
    If score is < 0
      score = Get score

  Get score:
      if being processed
        return -1 // infinite loop protection
      tempscore = 0
      if not ignore this track
        if seed track
          score = 1
        else
          set track as "being processed"
          for all tracks related to this one
            if (parent's score != -1)
              tempscore += (match score / max + 1) * parent's score
          set track as not "being processed"
          if tempscore > 0.99
            tempscore = 0.99
       if (all parent's scores = -1)
         return -1
       else
         return tempscore
}}}

= Similar Artist Scoring =

Note: No upper limit on score so make sure seed artists are shown first regardless of score.

{{{
  Set all scores to -1
  For all artists
    If score is < 0
      score Get similar artist score

  Get similar artist score:
      if being processed
        return // infinite loop protection
      tempscore = 0
      if not ignore this artist
        if seed artist
          score = 1
        else
          set track as "being processed"
          for all artists related to this one
            if (parent's score != -1)
              tempscore += (match score / 101) * parent's score            
          set track as not "being processed"
       if (all parent's scores = -1)
         return -1
       else
         return tempscore
}}}